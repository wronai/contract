{
  "$defs": {
    "AppDefinition": {
      "description": "Application metadata",
      "properties": {
        "name": {
          "minLength": 1,
          "title": "Name",
          "type": "string"
        },
        "version": {
          "minLength": 1,
          "title": "Version",
          "type": "string"
        },
        "description": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Description"
        },
        "author": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Author"
        },
        "license": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "License"
        }
      },
      "required": [
        "name",
        "version"
      ],
      "title": "AppDefinition",
      "type": "object"
    },
    "AssertionCheck": {
      "description": "Check definition for assertions",
      "properties": {
        "type": {
          "enum": [
            "file-exists",
            "file-contains",
            "file-not-contains",
            "exports-function",
            "exports-class",
            "has-error-handling",
            "has-validation"
          ],
          "title": "Type",
          "type": "string"
        },
        "path": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Path"
        },
        "pattern": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Pattern"
        },
        "functionName": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Functionname"
        },
        "className": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Classname"
        },
        "entityName": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Entityname"
        },
        "fieldName": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Fieldname"
        }
      },
      "required": [
        "type"
      ],
      "title": "AssertionCheck",
      "type": "object"
    },
    "CodeAssertion": {
      "description": "Assertion for validating generated code",
      "properties": {
        "id": {
          "pattern": "^A\\d{3}$",
          "title": "Id",
          "type": "string"
        },
        "description": {
          "title": "Description",
          "type": "string"
        },
        "check": {
          "$ref": "#/$defs/AssertionCheck"
        },
        "severity": {
          "default": "error",
          "enum": [
            "error",
            "warning"
          ],
          "title": "Severity",
          "type": "string"
        },
        "errorMessage": {
          "title": "Errormessage",
          "type": "string"
        }
      },
      "required": [
        "id",
        "description",
        "check",
        "errorMessage"
      ],
      "title": "CodeAssertion",
      "type": "object"
    },
    "CodePattern": {
      "description": "Code pattern for LLM to follow",
      "properties": {
        "name": {
          "title": "Name",
          "type": "string"
        },
        "description": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Description"
        },
        "appliesTo": {
          "default": [],
          "items": {
            "enum": [
              "api",
              "frontend",
              "database",
              "tests",
              "docker",
              "all"
            ],
            "type": "string"
          },
          "title": "Appliesto",
          "type": "array"
        },
        "template": {
          "title": "Template",
          "type": "string"
        },
        "variables": {
          "anyOf": [
            {
              "items": {
                "$ref": "#/$defs/PatternVariable"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Variables"
        }
      },
      "required": [
        "name",
        "template"
      ],
      "title": "CodePattern",
      "type": "object"
    },
    "ContractMetadata": {
      "description": "Contract metadata",
      "properties": {
        "version": {
          "default": "1.0.0",
          "title": "Version",
          "type": "string"
        },
        "createdAt": {
          "format": "date-time",
          "title": "Createdat",
          "type": "string"
        },
        "updatedAt": {
          "anyOf": [
            {
              "format": "date-time",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Updatedat"
        }
      },
      "title": "ContractMetadata",
      "type": "object"
    },
    "DefinitionLayer": {
      "description": "Layer 1: What to build",
      "properties": {
        "app": {
          "$ref": "#/$defs/AppDefinition"
        },
        "entities": {
          "items": {
            "$ref": "#/$defs/EntityDefinition"
          },
          "title": "Entities",
          "type": "array"
        }
      },
      "required": [
        "app",
        "entities"
      ],
      "title": "DefinitionLayer",
      "type": "object"
    },
    "EntityDefinition": {
      "description": "Complete entity definition",
      "properties": {
        "name": {
          "minLength": 1,
          "title": "Name",
          "type": "string"
        },
        "description": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Description"
        },
        "fields": {
          "items": {
            "$ref": "#/$defs/EntityField"
          },
          "title": "Fields",
          "type": "array"
        }
      },
      "required": [
        "name",
        "fields"
      ],
      "title": "EntityDefinition",
      "type": "object"
    },
    "EntityField": {
      "description": "Definition of a single entity field",
      "properties": {
        "name": {
          "minLength": 1,
          "title": "Name",
          "type": "string"
        },
        "type": {
          "$ref": "#/$defs/FieldType"
        },
        "annotations": {
          "anyOf": [
            {
              "$ref": "#/$defs/FieldAnnotations"
            },
            {
              "type": "null"
            }
          ],
          "default": null
        }
      },
      "required": [
        "name",
        "type"
      ],
      "title": "EntityField",
      "type": "object"
    },
    "FieldAnnotations": {
      "description": "Annotations for entity fields",
      "properties": {
        "required": {
          "default": true,
          "title": "Required",
          "type": "boolean"
        },
        "unique": {
          "default": false,
          "title": "Unique",
          "type": "boolean"
        },
        "generated": {
          "default": false,
          "title": "Generated",
          "type": "boolean"
        },
        "min_length": {
          "anyOf": [
            {
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Min Length"
        },
        "max_length": {
          "anyOf": [
            {
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Max Length"
        },
        "pattern": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Pattern"
        },
        "min": {
          "anyOf": [
            {
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Min"
        },
        "max": {
          "anyOf": [
            {
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Max"
        },
        "default": {
          "anyOf": [
            {},
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Default"
        },
        "description": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Description"
        }
      },
      "title": "FieldAnnotations",
      "type": "object"
    },
    "FieldType": {
      "description": "Supported field types in contracts",
      "enum": [
        "UUID",
        "String",
        "Text",
        "Email",
        "URL",
        "Phone",
        "Int",
        "Integer",
        "Float",
        "Decimal",
        "Number",
        "Boolean",
        "Date",
        "DateTime",
        "Timestamp",
        "JSON",
        "Array"
      ],
      "title": "FieldType",
      "type": "string"
    },
    "GenerationInstruction": {
      "description": "Instruction for code generation",
      "properties": {
        "target": {
          "enum": [
            "api",
            "frontend",
            "database",
            "tests",
            "docker",
            "all"
          ],
          "title": "Target",
          "type": "string"
        },
        "priority": {
          "default": "must",
          "enum": [
            "must",
            "should",
            "may"
          ],
          "title": "Priority",
          "type": "string"
        },
        "instruction": {
          "title": "Instruction",
          "type": "string"
        },
        "examples": {
          "anyOf": [
            {
              "items": {
                "additionalProperties": true,
                "type": "object"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Examples"
        }
      },
      "required": [
        "target",
        "instruction"
      ],
      "title": "GenerationInstruction",
      "type": "object"
    },
    "GenerationLayer": {
      "description": "Layer 2: How to build",
      "properties": {
        "instructions": {
          "default": [],
          "items": {
            "$ref": "#/$defs/GenerationInstruction"
          },
          "title": "Instructions",
          "type": "array"
        },
        "patterns": {
          "default": [],
          "items": {
            "$ref": "#/$defs/CodePattern"
          },
          "title": "Patterns",
          "type": "array"
        },
        "constraints": {
          "default": [],
          "items": {
            "$ref": "#/$defs/TechnicalConstraint"
          },
          "title": "Constraints",
          "type": "array"
        },
        "techStack": {
          "additionalProperties": true,
          "title": "Techstack",
          "type": "object"
        },
        "templates": {
          "additionalProperties": {
            "type": "string"
          },
          "default": {},
          "title": "Templates",
          "type": "object"
        }
      },
      "title": "GenerationLayer",
      "type": "object"
    },
    "PatternVariable": {
      "description": "Variable used in a code pattern",
      "properties": {
        "name": {
          "title": "Name",
          "type": "string"
        },
        "description": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Description"
        },
        "type": {
          "default": "string",
          "enum": [
            "string",
            "number",
            "boolean",
            "array",
            "object"
          ],
          "title": "Type",
          "type": "string"
        },
        "default": {
          "anyOf": [
            {},
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Default"
        },
        "required": {
          "anyOf": [
            {
              "type": "boolean"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Required"
        }
      },
      "required": [
        "name"
      ],
      "title": "PatternVariable",
      "type": "object"
    },
    "TechnicalConstraint": {
      "description": "Technical constraint",
      "properties": {
        "type": {
          "title": "Type",
          "type": "string"
        },
        "rule": {
          "title": "Rule",
          "type": "string"
        },
        "severity": {
          "default": "error",
          "enum": [
            "error",
            "warning"
          ],
          "title": "Severity",
          "type": "string"
        },
        "autoFix": {
          "anyOf": [
            {
              "type": "boolean"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Autofix"
        }
      },
      "required": [
        "type",
        "rule"
      ],
      "title": "TechnicalConstraint",
      "type": "object"
    },
    "ValidationLayer": {
      "description": "Layer 3: How to validate",
      "properties": {
        "assertions": {
          "default": [],
          "items": {
            "$ref": "#/$defs/CodeAssertion"
          },
          "title": "Assertions",
          "type": "array"
        },
        "tests": {
          "default": [],
          "items": {
            "additionalProperties": true,
            "type": "object"
          },
          "title": "Tests",
          "type": "array"
        },
        "staticRules": {
          "items": {
            "additionalProperties": true,
            "type": "object"
          },
          "title": "Staticrules",
          "type": "array"
        },
        "qualityGates": {
          "items": {
            "additionalProperties": true,
            "type": "object"
          },
          "title": "Qualitygates",
          "type": "array"
        },
        "acceptance": {
          "additionalProperties": true,
          "title": "Acceptance",
          "type": "object"
        }
      },
      "title": "ValidationLayer",
      "type": "object"
    }
  },
  "description": "Complete Contract AI definition (3 layers)",
  "properties": {
    "definition": {
      "$ref": "#/$defs/DefinitionLayer"
    },
    "generation": {
      "$ref": "#/$defs/GenerationLayer"
    },
    "validation": {
      "$ref": "#/$defs/ValidationLayer"
    },
    "metadata": {
      "anyOf": [
        {
          "$ref": "#/$defs/ContractMetadata"
        },
        {
          "type": "null"
        }
      ],
      "default": null
    }
  },
  "required": [
    "definition",
    "generation",
    "validation"
  ],
  "title": "ContractAI",
  "type": "object"
}